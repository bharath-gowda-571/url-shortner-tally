{"ast":null,"code":"import _asyncToGenerator from \"/home/bharath/Desktop/drive2/tally-hackathon/url-shortner/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { monkeyPatchChartJsLegend, monkeyPatchChartJsTooltip } from 'ng2-charts';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/firebase-auth.service\";\nimport * as i3 from \"../navbar/navbar.component\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"ng2-charts\";\n\nfunction ViewstatsComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵtext(1, \"No Visits to this link yet\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ViewstatsComponent_div_2_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"No Visits to this link yet\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ViewstatsComponent_div_2_table_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 15);\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵelementStart(2, \"td\", 16);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\", 17);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"tr\", 18);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const count_r5 = ctx.$implicit;\n    const i_r6 = ctx.index;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r3.barChartLabels[i_r6]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(count_r5);\n  }\n}\n\nfunction ViewstatsComponent_div_2_table_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 15);\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵelementStart(2, \"td\", 16);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\", 17);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"tr\", 18);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const log_r7 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(log_r7.date);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate8(\"\", \"browser=\" + log_r7.browser, \", \", \"device type=\" + log_r7.deviceType, \", \", \"os=\" + log_r7.os, \", \", \"country=\" + log_r7.country, \", \", \"state=\" + log_r7.state, \", \", \"city=\" + log_r7.city, \", \", \"latitude=\" + log_r7.latitude, \", \", \"longitude=\" + log_r7.longitude, \"\");\n  }\n}\n\nfunction ViewstatsComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"h4\", 3);\n    i0.ɵɵelementStart(2, \"u\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"hr\");\n    i0.ɵɵelementStart(5, \"div\", 4);\n    i0.ɵɵelementStart(6, \"div\", 5);\n    i0.ɵɵelementStart(7, \"h4\", 6);\n    i0.ɵɵtext(8, \"Operating System\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 7);\n    i0.ɵɵelement(10, \"canvas\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\", 5);\n    i0.ɵɵelementStart(12, \"h4\", 6);\n    i0.ɵɵtext(13, \"Browser\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 7);\n    i0.ɵɵelement(15, \"canvas\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 5);\n    i0.ɵɵelementStart(17, \"h4\", 6);\n    i0.ɵɵtext(18, \"Device-type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(19, ViewstatsComponent_div_2_div_19_Template, 2, 0, \"div\", 1);\n    i0.ɵɵelementStart(20, \"div\", 7);\n    i0.ɵɵelement(21, \"canvas\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(22, \"hr\");\n    i0.ɵɵelementStart(23, \"div\", 4);\n    i0.ɵɵelementStart(24, \"div\", 9);\n    i0.ɵɵelementStart(25, \"h4\", 6);\n    i0.ɵɵtext(26, \"Country-Data\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(27, ViewstatsComponent_div_2_table_27_Template, 7, 2, \"table\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"div\", 9);\n    i0.ɵɵelementStart(29, \"h4\", 6);\n    i0.ɵɵtext(30, \"Country-Chart\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"div\", 11);\n    i0.ɵɵelement(32, \"canvas\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(33, \"hr\");\n    i0.ɵɵelementStart(34, \"div\", 4);\n    i0.ɵɵelementStart(35, \"div\", 13);\n    i0.ɵɵelementStart(36, \"h2\", 14);\n    i0.ɵɵtext(37, \"All Logs\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(38, ViewstatsComponent_div_2_table_38_Template, 7, 9, \"table\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Current Link: \", ctx_r1.key, \"\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"data\", ctx_r1.pieChartData1)(\"labels\", ctx_r1.pieChartLabels1)(\"chartType\", ctx_r1.pieChartType1)(\"options\", ctx_r1.pieChartOptions)(\"plugins\", ctx_r1.pieChartPlugins1)(\"legend\", ctx_r1.pieChartLegend1)(\"colors\", ctx_r1.donutColors1);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"data\", ctx_r1.pieChartData2)(\"labels\", ctx_r1.pieChartLabels2)(\"chartType\", ctx_r1.pieChartType2)(\"options\", ctx_r1.pieChartOptions)(\"plugins\", ctx_r1.pieChartPlugins2)(\"legend\", ctx_r1.pieChartLegend2)(\"colors\", ctx_r1.donutColors1);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.no_data);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"data\", ctx_r1.pieChartData3)(\"labels\", ctx_r1.pieChartLabels3)(\"chartType\", ctx_r1.pieChartType3)(\"options\", ctx_r1.pieChartOptions)(\"plugins\", ctx_r1.pieChartPlugins3)(\"legend\", ctx_r1.pieChartLegend3)(\"colors\", ctx_r1.donutColors1);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.barChart2Data);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"data\", ctx_r1.barChart2Data)(\"labels\", ctx_r1.barChartLabels)(\"options\", ctx_r1.barChart2Options)(\"plugins\", ctx_r1.barChart2Plugins)(\"legend\", ctx_r1.barChart2Legend)(\"chartType\", ctx_r1.barChart2Type);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.logs.reverse());\n  }\n}\n\nexport let ViewstatsComponent = /*#__PURE__*/(() => {\n  class ViewstatsComponent {\n    constructor(route, firebaseService, _route) {\n      this.route = route;\n      this.firebaseService = firebaseService;\n      this._route = _route;\n      this.no_data = false;\n      this.pieChartLabels1 = [];\n      this.pieChartData1 = [];\n      this.pieChartType1 = 'pie';\n      this.pieChartLegend1 = true;\n      this.pieChartPlugins1 = [];\n      this.pieChartLabels2 = [];\n      this.pieChartData2 = [];\n      this.pieChartType2 = 'pie';\n      this.pieChartLegend2 = true;\n      this.pieChartPlugins2 = [];\n      this.pieChartLabels3 = [];\n      this.pieChartData3 = [];\n      this.pieChartType3 = 'pie';\n      this.pieChartLegend3 = true;\n      this.pieChartPlugins3 = [];\n      this.barChartLabels = [];\n      this.barChart2Type = 'bar';\n      this.barChart2Legend = false;\n      this.barChart2Plugins = [];\n      this.barChart2Data = [];\n      this.donutColors1 = [{\n        backgroundColor: ['rgba(92, 184, 92,1)', 'rgba(255, 195, 0, 1)', 'rgba(217, 83, 79,1)', 'rgba(129, 78, 40, 1)', 'rgba(129, 199, 111, 1)']\n      }];\n      this.barChart2Options = {\n        responsive: true,\n        scales: {\n          yAxes: [{\n            ticks: {\n              beginAtZero: true\n            }\n          }]\n        }\n      };\n      this.pieChartOptions = {\n        responsive: true,\n        legend: {\n          position: \"top\"\n        }\n      };\n      monkeyPatchChartJsLegend();\n      monkeyPatchChartJsTooltip();\n    }\n\n    ngOnInit() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        var user = localStorage.getItem(\"user\");\n\n        if (user === null) {\n          _this._route.navigate(['/']);\n        }\n\n        _this.key = _this.route.snapshot.paramMap.get(\"key\");\n        _this.logs = yield _this.firebaseService.get_logs(_this.key);\n\n        if (_this.logs == null) {\n          _this.no_data = true;\n        } else {\n          console.log(_this.logs);\n\n          for (var log of _this.logs) {\n            if (!_this.pieChartLabels1.includes(log.os)) {\n              _this.pieChartLabels1.push(log.os);\n\n              _this.pieChartData1.push(1);\n            } else {\n              _this.pieChartData1[_this.pieChartLabels1.indexOf(log.os)] += 1;\n            }\n\n            if (!_this.pieChartLabels2.includes(log.browser)) {\n              _this.pieChartLabels2.push(log.browser);\n\n              _this.pieChartData2.push(1);\n            } else {\n              _this.pieChartData2[_this.pieChartLabels2.indexOf(log.browser)] += 1;\n            }\n\n            if (!_this.pieChartLabels3.includes(log.deviceType)) {\n              _this.pieChartLabels3.push(log.deviceType);\n\n              _this.pieChartData3.push(1);\n            } else {\n              _this.pieChartData3[_this.pieChartLabels3.indexOf(log.deviceType)] += 1;\n            }\n\n            if (!_this.barChartLabels.includes(log.country)) {\n              _this.barChartLabels.push(log.country);\n\n              _this.barChart2Data.push(1);\n            } else {\n              _this.barChart2Data[_this.barChartLabels.indexOf(log.country)] += 1;\n            }\n          }\n        }\n      })();\n    }\n\n  }\n\n  ViewstatsComponent.ɵfac = function ViewstatsComponent_Factory(t) {\n    return new (t || ViewstatsComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.FirebaseAuthService), i0.ɵɵdirectiveInject(i1.Router));\n  };\n\n  ViewstatsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ViewstatsComponent,\n    selectors: [[\"app-viewstats\"]],\n    decls: 3,\n    vars: 2,\n    consts: [[\"style\", \"text-align: center; margin: 20px; \", 4, \"ngIf\"], [4, \"ngIf\"], [2, \"text-align\", \"center\", \"margin\", \"20px\"], [2, \"margin\", \"30px\"], [1, \"row\"], [1, \"col-md-4\"], [2, \"text-align\", \"center\"], [1, \"pie-chart\"], [\"baseChart\", \"\", 3, \"data\", \"labels\", \"chartType\", \"options\", \"plugins\", \"legend\", \"colors\"], [1, \"col-md-6\"], [\"class\", \"main-stats-table\", 4, \"ngFor\", \"ngForOf\"], [1, \"bar-chart\"], [\"baseChart\", \"\", 3, \"data\", \"labels\", \"options\", \"plugins\", \"legend\", \"chartType\"], [1, \"col-md-12\"], [2, \"text-align\", \"left\", \"margin\", \"40px\"], [1, \"main-stats-table\"], [1, \"main-stats-table-left\"], [1, \"main-stats-table-right\"], [1, \"main-stats-table-spacer\"]],\n    template: function ViewstatsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-navbar\");\n        i0.ɵɵtemplate(1, ViewstatsComponent_div_1_Template, 2, 0, \"div\", 0);\n        i0.ɵɵtemplate(2, ViewstatsComponent_div_2_Template, 39, 31, \"div\", 1);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.no_data);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.no_data);\n      }\n    },\n    directives: [i3.NavbarComponent, i4.NgIf, i5.BaseChartDirective, i4.NgForOf],\n    styles: [\".main-stats-table[_ngcontent-%COMP%]{margin-left:5%;width:90%;height:40px;margin-right:5%}.main-stats-table-left[_ngcontent-%COMP%]{background-color:#dcdcdc;text-align:left;padding-left:10px;width:40%}.main-stats-table-right[_ngcontent-%COMP%]{background-color:#c4c4c4;width:40%;text-align:center}.main-stats-table-spacer[_ngcontent-%COMP%]{height:2px}\"]\n  });\n  return ViewstatsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}