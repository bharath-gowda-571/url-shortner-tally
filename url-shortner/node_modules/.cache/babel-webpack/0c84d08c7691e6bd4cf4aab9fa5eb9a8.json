{"ast":null,"code":"import _asyncToGenerator from \"/home/bharath/Desktop/drive2/tally-hackathon/url-shortner/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { getAuth } from 'firebase/auth';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/auth\";\nimport * as i2 from \"@angular/common/http\";\nexport class FirebaseAuthService {\n  constructor(firebaseAuth, _http) {\n    this.firebaseAuth = firebaseAuth;\n    this._http = _http;\n    this.isLoggedIn = false;\n  }\n\n  signin(email, password) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var error_msg = \"\";\n      yield _this.firebaseAuth.signInWithEmailAndPassword(email, password).then(res => {\n        _this.isLoggedIn = true;\n        const auth = getAuth();\n        const user = auth.currentUser;\n        var uid = user === null || user === void 0 ? void 0 : user.uid;\n        localStorage.setItem('user', uid.toString());\n      }).catch(e => {\n        error_msg = \"Wrong Email or Password\";\n      });\n      return error_msg;\n    })();\n  }\n\n  signup(email, password, first_name, last_name) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      var error_msg = \"\";\n      yield _this2.firebaseAuth.createUserWithEmailAndPassword(email, password).then(res => {\n        _this2.isLoggedIn = true;\n        const auth = getAuth();\n        const user = auth.currentUser;\n        var uid = user === null || user === void 0 ? void 0 : user.uid;\n        localStorage.setItem('user', uid.toString());\n\n        _this2._http.put(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/users/\" + uid + \".json\", {\n          \"first_name\": first_name,\n          \"last name\": last_name\n        }).subscribe(data => {});\n      }).catch(e => {\n        var e_str = e.toString();\n\n        if (e_str.search(\"email-already-in-use\") != -1) {\n          error_msg = \"User already exists\";\n        } else if (e_str.search(\"invalid-email\") != -1) {\n          error_msg = \"Invalid Email\";\n        } else if (e_str.search(\"weak-password\") != -1) {\n          error_msg = \"Weak Password\";\n        }\n\n        return error_msg;\n      });\n      return error_msg;\n    })();\n  }\n\n  logout() {\n    this.firebaseAuth.signOut();\n    localStorage.removeItem('user');\n  }\n\n  getUserFirstName() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      var uid = localStorage.getItem(\"user\");\n      var first_name = yield _this3._http.get(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/users/\" + uid.toString() + \"/first_name.json\").toPromise();\n      return first_name;\n    })();\n  }\n\n  getListofKeys() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      return yield _this4._http.get(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/shortened_urls.json\").toPromise();\n    })();\n  }\n\n  add_new_link(short_link, long_link) {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      _this5._http.put(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/shortened_urls/\" + short_link + \".json\", {\n        \"fullink\": long_link\n      }).subscribe(data => {});\n\n      var uid = localStorage.getItem(\"user\");\n      var user_links = yield _this5._http.get(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/users/\" + uid + \"/links.json\").toPromise();\n      console.log(user_links);\n\n      if (user_links == null) {\n        user_links = [];\n      }\n\n      user_links.push({\n        fullink: long_link,\n        link: short_link\n      });\n\n      _this5._http.put(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/shortened_urls/\" + short_link + \".json\", {\n        \"fullink\": long_link\n      }).subscribe(data => {});\n    })();\n  }\n\n}\n\nFirebaseAuthService.ɵfac = function FirebaseAuthService_Factory(t) {\n  return new (t || FirebaseAuthService)(i0.ɵɵinject(i1.AngularFireAuth), i0.ɵɵinject(i2.HttpClient));\n};\n\nFirebaseAuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: FirebaseAuthService,\n  factory: FirebaseAuthService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/home/bharath/Desktop/drive2/tally-hackathon/url-shortner/src/app/services/firebase-auth.service.ts"],"names":["getAuth","i0","i1","i2","FirebaseAuthService","constructor","firebaseAuth","_http","isLoggedIn","signin","email","password","error_msg","signInWithEmailAndPassword","then","res","auth","user","currentUser","uid","localStorage","setItem","toString","catch","e","signup","first_name","last_name","createUserWithEmailAndPassword","put","subscribe","data","e_str","search","logout","signOut","removeItem","getUserFirstName","getItem","get","toPromise","getListofKeys","add_new_link","short_link","long_link","user_links","console","log","push","fullink","link","ɵfac","FirebaseAuthService_Factory","t","ɵɵinject","AngularFireAuth","HttpClient","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import { getAuth } from 'firebase/auth';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/auth\";\nimport * as i2 from \"@angular/common/http\";\nexport class FirebaseAuthService {\n    constructor(firebaseAuth, _http) {\n        this.firebaseAuth = firebaseAuth;\n        this._http = _http;\n        this.isLoggedIn = false;\n    }\n    async signin(email, password) {\n        var error_msg = \"\";\n        await this.firebaseAuth.signInWithEmailAndPassword(email, password).then(res => {\n            this.isLoggedIn = true;\n            const auth = getAuth();\n            const user = auth.currentUser;\n            var uid = user === null || user === void 0 ? void 0 : user.uid;\n            localStorage.setItem('user', uid.toString());\n        }).catch(e => {\n            error_msg = \"Wrong Email or Password\";\n        });\n        return error_msg;\n    }\n    async signup(email, password, first_name, last_name) {\n        var error_msg = \"\";\n        await this.firebaseAuth.createUserWithEmailAndPassword(email, password).then(res => {\n            this.isLoggedIn = true;\n            const auth = getAuth();\n            const user = auth.currentUser;\n            var uid = user === null || user === void 0 ? void 0 : user.uid;\n            localStorage.setItem('user', uid.toString());\n            this._http.put(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/users/\" + uid + \".json\", { \"first_name\": first_name, \"last name\": last_name }).subscribe(data => {\n            });\n        }).catch(e => {\n            var e_str = e.toString();\n            if (e_str.search(\"email-already-in-use\") != -1) {\n                error_msg = \"User already exists\";\n            }\n            else if (e_str.search(\"invalid-email\") != -1) {\n                error_msg = \"Invalid Email\";\n            }\n            else if (e_str.search(\"weak-password\") != -1) {\n                error_msg = \"Weak Password\";\n            }\n            return error_msg;\n        });\n        return error_msg;\n    }\n    logout() {\n        this.firebaseAuth.signOut();\n        localStorage.removeItem('user');\n    }\n    async getUserFirstName() {\n        var uid = localStorage.getItem(\"user\");\n        var first_name = await this._http.get(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/users/\" + uid.toString() + \"/first_name.json\").toPromise();\n        return first_name;\n    }\n    async getListofKeys() {\n        return await this._http.get(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/shortened_urls.json\").toPromise();\n    }\n    async add_new_link(short_link, long_link) {\n        this._http.put(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/shortened_urls/\" + short_link + \".json\", { \"fullink\": long_link }).subscribe(data => {\n        });\n        var uid = localStorage.getItem(\"user\");\n        var user_links = await this._http.get(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/users/\" + uid + \"/links.json\").toPromise();\n        console.log(user_links);\n        if (user_links == null) {\n            user_links = [];\n        }\n        user_links.push({\n            fullink: long_link,\n            link: short_link\n        });\n        this._http.put(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/shortened_urls/\" + short_link + \".json\", { \"fullink\": long_link }).subscribe(data => {\n        });\n    }\n}\nFirebaseAuthService.ɵfac = function FirebaseAuthService_Factory(t) { return new (t || FirebaseAuthService)(i0.ɵɵinject(i1.AngularFireAuth), i0.ɵɵinject(i2.HttpClient)); };\nFirebaseAuthService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FirebaseAuthService, factory: FirebaseAuthService.ɵfac, providedIn: 'root' });\n"]},"metadata":{},"sourceType":"module"}