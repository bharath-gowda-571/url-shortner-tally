{"ast":null,"code":"import _asyncToGenerator from \"/home/bharath/Desktop/drive2/tally-hackathon/url-shortner/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { formatDate } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let RedirectionService = /*#__PURE__*/(() => {\n  class RedirectionService {\n    constructor(http) {\n      this.http = http;\n    }\n\n    viewLink(short_url) {\n      return this.http.get(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/shortened_urls/\" + short_url + \"/fullink.json\").toPromise();\n    }\n\n    getHisLinks(userId) {\n      return this.http.get(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/users/\" + userId + \"/links.json\");\n    }\n\n    regLog(short_url, logs1) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        var today = new Date(); // var ip=await this.http.get<IPFormat>(\"https://api64.ipify.org?format=json\").toPromise() \n        // var location_data=await this.http.get<Location>(\"https://ipapi.co/\"+ip.ip+\"/json/\").toPromise()\n        //logs1.city = location_data.city\n        //logs1.country = location_data.country_name\n        //logs1.state = location_data.region\n        //logs1.latitude = location_data.latitude\n        //logs1.longitude = location_data.longitude\n\n        logs1.date = formatDate(today, 'dd-MM-yyyy hh:mm:ss a', 'en-US', '+0000');\n        var arr = [];\n        var newLog = logs1;\n        var data = yield _this.http.get(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/shortened_urls/\" + short_url + \"/logs.json\").toPromise();\n\n        if (data != null) {\n          arr = data;\n        }\n\n        arr.push(newLog);\n        return yield _this.addLog1(short_url, arr);\n      })();\n    }\n\n    addLog1(short_url, arr) {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        return yield _this2.http.put(\"https://url-shortner-418d4-default-rtdb.asia-southeast1.firebasedatabase.app/shortened_urls/\" + short_url + \"/logs.json\", arr).toPromise();\n      })();\n    }\n\n  }\n\n  RedirectionService.ɵfac = function RedirectionService_Factory(t) {\n    return new (t || RedirectionService)(i0.ɵɵinject(i1.HttpClient));\n  };\n\n  RedirectionService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: RedirectionService,\n    factory: RedirectionService.ɵfac,\n    providedIn: 'root'\n  });\n  return RedirectionService;\n})();","map":null,"metadata":{},"sourceType":"module"}